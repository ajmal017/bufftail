#include_once <stir_spread.afl>
#include <z_score.afl>
#include <volatility_filter.afl>
#include_once <runs_test_zscore.afl>

autocorrelation = ComputeRunZ(ROC(C,1), lookback);
acr = autocorrelation * ROC(C,lookback);
negative_momentum = acr <= LLV(acr,lookback) && ROC(acr,lookback) < 0;
zz = zscore(ROC(C,1),lookback) ; 
zs = zscore(StDev(C,lookback), lookback) ; 
zcomb = (zz+zs)/2; 
short_volatility = Cross( -1, zcomb ) && C <= MA(C,lookback);

Short = volume_filter && volatility_filter  && (short_volatility && negative_momentum) ;
Buy = Sell = Cover = False;