#include_once "Formulas\Custom\runs_test.afl";

PositionSize = MarginDeposit;

lookback = Optimize("", )
Z = ComputeRunZ( ROC(C,1), 10 );
z_threshold = Optimize("z threshold", 1.65, 1.65, 2.0, 0.05) ;

Buy = volatility_filter &&  Z > z_threshold && ROC(C,1) < 0 ;
Sell = True;

Short = Z > z_threshold && ROC(C,1) > 0 ;
Cover = True;

ApplyStop( stopTypeLoss, stopModePercent, 0.25, 1 );